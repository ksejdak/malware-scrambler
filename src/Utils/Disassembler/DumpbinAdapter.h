#ifndef DUMPBINADAPTER_H
#define DUMPBINADAPTER_H

#include "AssemblerInstruction.h"

#include <vector>
#include <boost\filesystem.hpp>

class DumpbinAdapter
{
public:
    /// @brief Constructor
    /// @param [in] PEFile          path to PE file that must be dumpbined
    /// @param [in] entryPointVA    virtual address of entry point
    DumpbinAdapter(const boost::filesystem::path& PEFile, size_t entryPointVA);

    /// @brief Virtual destructor
    virtual ~DumpbinAdapter() {}

    /// @brief Launches Microsoft dumbin application on given PE file
    void dump();

private:
    boost::filesystem::path m_PEFile;
    size_t m_entryPointVA;
    std::vector<AssemblerInstruction> m_instructions;
};

#endif